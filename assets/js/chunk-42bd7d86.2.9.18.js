(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-42bd7d86"],{"0dd5":function(t,s,e){"use strict";e("fe1a")},"4a33":function(t,s,e){"use strict";e.r(s);var a=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"container"},[e("div",{staticClass:"content"},[e("div",[e("Row",{attrs:{gutter:0,type:"flex",justify:"center"}},[e("Col",{staticStyle:{width:"500px"}},[e("br"),e("Row",[e("Col",{attrs:{xs:{push:1},lg:{push:0}}},[e("Breadcrumb",[e("BreadcrumbItem",{attrs:{to:{name:"home"}}},[t._v(t._s(t.$t("header.index")))]),e("BreadcrumbItem",[t._v(t._s(t.$t("signin.title")))])],1)],1)],1),e("br"),t.isLogin?t._e():e("Card",{staticClass:"signin-box",attrs:{padding:t.isMobile?20:30,"dis-hover":""}},[e("Banner",{style:"margin: -"+(t.isMobile?20:30)+"px -"+(t.isMobile?20:30)+"px 30px;",attrs:{showScale:2.5,height:180}}),e("Form",{ref:"signin",attrs:{model:t.signin,rules:t.ruleValidate,"label-position":"top"}},[t.serverReturnMessage?e("Alert",{attrs:{type:"error","show-icon":""}},[e("b",[t._v(t._s(t.$t("signin.failed"))+" :")]),t._v(" "+t._s(t.serverReturnMessage)+" ")]):t._e(),e("FormItem",{attrs:{label:t.$t("signin.form.username"),prop:"username"}},[e("Input",{attrs:{prefix:"ios-contact",type:"text",size:"large",placeholder:t.$t("signin.form.username")},model:{value:t.signin.username,callback:function(s){t.$set(t.signin,"username",s)},expression:"signin.username"}})],1),e("FormItem",{attrs:{label:t.$t("signin.form.password"),prop:"password"}},[e("Input",{attrs:{type:"password",password:"",size:"large",placeholder:t.$t("signin.form.password")},model:{value:t.signin.password,callback:function(s){t.$set(t.signin,"password",s)},expression:"signin.password"}})],1),e("FormItem",{attrs:{label:t.$t("captcha.title"),prop:"captcha"}},[e("Captcha",{ref:"captcha",attrs:{size:"large"},on:{getCaptchaData:t.getCaptchaData}})],1),e("br"),e("FormItem",[e("Button",{attrs:{long:"",loading:t.spinShow,size:"large",type:"primary"},on:{click:t.onSignin}},[t._v(" "+t._s(t.$t("basic.button.submit"))+" ")]),e("Button",{directives:[{name:"show",rawName:"v-show",value:t.$route.query.byPath,expression:"$route.query.byPath"}],staticStyle:{"margin-top":"10px"},attrs:{long:"",size:"large",type:"text"},on:{click:t.onBackRouter}},[t._v(" "+t._s(t.$t("basic.button.cancel"))+" ")])],1),t.spinShow?e("spin",{attrs:{fix:""}},[e("Icon",{attrs:{type:"md-refresh spin-icon-load",size:"30"}})],1):t._e()],1),e("Divider",{style:"margin:25px -"+(t.isMobile?20:50)+"px;width:calc(100% + "+(t.isMobile?40:100)+"px)",attrs:{dashed:""}}),e("Row",{attrs:{gutter:10,type:"flex",align:"middle"}},[e("Col",[e("router-link",{attrs:{to:{name:"signup"}}},[t._v(" "+t._s(t.$t("signin.form.submitHint"))+" ")])],1),e("Divider",{attrs:{type:"vertical"}}),e("Col",[e("router-link",{attrs:{to:{name:"forgetPassword"}}},[t._v(t._s(t.$t("signin.form.forgetPasswordHint")))])],1)],1)],1),t.isLogin?e("Card",{attrs:{"dis-hover":"",padding:t.isMobile?20:50}},[e("div",{staticClass:"signin-out-userinfo"},[e("Avatar",{staticClass:"userinfo-avatar",attrs:{icon:"ios-person",size:"100",src:t.currentUser.userinfo.userAvatar}}),e("h1",[e("router-link",{attrs:{to:{name:"profile",params:{pagename:"information"}}}},[t._v(" "+t._s(t.currentUser.userinfo.username)+" ")])],1),e("p",[t._v(" "+t._s(t.$t("signin.loggedIn"))+" ")])],1),e("Button",{attrs:{long:"",type:"error",ghost:"",size:"large",loading:t.signoutLoad,disabled:t.signoutLoad},on:{click:t.onAccountSignout}},[t._v(" "+t._s(t.$t("header.signout"))+" ")])],1):t._e()],1)],1)],1)])])},r=[],i=e("e4b4"),n=e("84af"),o=e("45ce"),c=e("2f62");const{mapActions:u,mapMutations:g}=c["a"];var p=new i["d"]({components:{Banner:n["a"],Captcha:o["a"]},data(){return{ruleValidate:{username:[{required:!0,min:4,max:40,trigger:"blur"},{validator(t,s,e){return 0==i["n"].check("username",s).code||0==i["n"].check("email",s).code},message:this.$t("signup.placeholder.username"),trigger:"change"}],password:[{required:!0,trigger:"blur"}],captcha:[{required:!0}]},serverReturnMessage:"",signin:{username:"",password:"",captcha:{}},signoutLoad:!1,spinShow:!1}},beforeMount(){this.$route.query.backPath&&this.$Message.info(this.$t("signin.loginFirst"))},methods:{...u({signinUser:"signin"}),...g(["SIGNIN"]),getCaptchaData(t){this.signin.captcha=Object.assign(this.signin.captcha,t),this.signin.captcha=t},async onAccountSignout(){try{this.signoutLoad=!0,await i["a"].signout(),this.$store.dispatch("signout").then(()=>{this.$router.push("/")})}catch(t){this.$Message.error(t.toString())}finally{this.signoutLoad=!1}},onSignin(){const t=this,s=this.$route.query.backPath;let{username:e,password:a,captcha:r}=this.signin;e=e.trim(),a=a.trim();try{this.$refs["signin"].validate(async n=>{if(!n)return void t.$Message.error(t.$t("signin.fillEverything"));t.spinShow=!0;const o=await i["e"].post(i["c"]["account_signin"],{data:{data:{username:e,password:a},captcha:r}}),c=o.data;if(1===c.error)throw t.signin.password="",t.signin.captcha="",t.serverReturnMessage=t.$t(`basic.tip['${c.code}']`,{message:c.message||""}),new Error(t.serverReturnMessage);await t.signinUser(c.data),s?await t.$router.push({path:s}):t.$router.go(-1),t.$Message.success(t.$t(`basic.tip['${c.code}']`,{message:c.message||""})),t.spinShow=!1,t.$refs.captcha&&t.$refs.captcha.refreshCaptcha()})}catch(n){n instanceof Error&&this.$Message.error(n)}},onBackRouter(){const t=this.$route.query.byPath;t&&this.$router.push({name:t})}},computed:{currentUser(){return this.$store.state.user||{token:""}}}}),l=p,d=(e("0dd5"),e("2877")),h=Object(d["a"])(l,a,r,!1,null,"2ab136c1",null);s["default"]=h.exports},fe1a:function(t,s,e){}}]);
//# sourceMappingURL=chunk-42bd7d86.2.9.18.js.map