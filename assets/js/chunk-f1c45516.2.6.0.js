(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f1c45516"],{"0b2c":function(e,t,a){"use strict";a("5011")},"20aa":function(e,t,a){"use strict";a("525c")},2953:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"container"},[t("br"),t("Row",[t("Col",{attrs:{xs:{push:1},lg:{push:0}}},[t("Breadcrumb",[t("BreadcrumbItem",{attrs:{to:{name:"home"}}},[e._v(e._s(e.$t("header.index")))]),t("BreadcrumbItem",{attrs:{to:{name:"profile",params:{pagename:"account"}}}},[e._v(e._s(e.$t("header.profile")))]),t("BreadcrumbItem",[e._v(e._s(e.$t("profile.admin.title")))])],1)],1)],1),t("br"),t("Card",{staticClass:"admin",attrs:{"dis-hover":"",padding:0}},[t("Row",{attrs:{gutter:0}},[t("Col",{attrs:{xs:{span:24},sm:{span:6}}},[t("Menu",{staticClass:"admin-menu",attrs:{"open-names":e.openMuen,"active-name":e.adminMenuValue},on:{"on-select":e.onMenuActive}},e._l(e.adminMuen,(function(a,s){return t("MenuGroup",{key:s,attrs:{title:e.$t("profile.admin.menu."+a.title)}},e._l(a.child,(function(a,s){return t("MenuItem",{key:s,attrs:{name:a.value}},[a.icon?t("Icon",{attrs:{type:a.icon}}):e._e(),e._v(" "+e._s(e.$t("profile.admin.menu."+a.title))+" ")],1)})),1)})),1)],1),t("Col",{staticStyle:{padding:"20px"},attrs:{xs:{span:24},sm:{span:18}}},["user"==e.adminMenuValue?t("user"):"comment"==e.adminMenuValue?t("comment"):"admin_log"==e.adminMenuValue?t("log"):"judgement_log"==e.adminMenuValue?t("judgementLog"):e._e()],1)],1)],1)],1)},i=[],r=function(){var e=this,t=e._self._c;return t("div",[t("Row",{attrs:{gutter:10}},[t("Col",{attrs:{flex:"1"}},[t("Input",{attrs:{placeholder:"Enter ..."},model:{value:e.userValue,callback:function(t){e.userValue=t},expression:"userValue"}})],1),t("Col",[t("Button",{attrs:{loading:e.load},on:{click:e.onSearchUser}},[e._v(e._s(e.$t("basic.button.submit")))])],1)],1),t("br"),e._l(e.userListData,(function(a,s){return t("Card",{key:s,staticClass:"admin-user",attrs:{"dis-hover":""}},[t("Row",{attrs:{gutter:10,type:"flex",justify:"center",align:"middle"}},[t("Col",{attrs:{flex:"1"}},[t("b",[e._v(e._s(a.username))]),t("p",[e._v("id: "+e._s(a.id))])]),t("Col",[t("PrivilegesTag",{attrs:{data:a.privilege}})],1),t("Col",[t("Button",{attrs:{type:"dashed",size:"small"},on:{click:function(t){return e.onEditUser(s)}}},[t("Icon",{attrs:{type:"ios-create"}})],1)],1)],1)],1)})),e.userListData.length<=0?t("div",[e._v(":(")]):e._e(),t("Modal",{attrs:{title:e.editUserData.username},on:{"on-ok":e.onSubmit},model:{value:e.userModel,callback:function(t){e.userModel=t},expression:"userModel"}},[t("Form",{ref:"formValidate",attrs:{model:e.editUserData,"label-position":"top"}},[t("Row",{attrs:{gutter:10}},[t("Col",{attrs:{span:"24"}},[t("FormItem",{attrs:{prop:"username"}},[t("Input",{model:{value:e.editUserData.username,callback:function(t){e.$set(e.editUserData,"username",t)},expression:"editUserData.username"}})],1)],1),t("Col",{attrs:{span:"12"}},[t("FormItem",{attrs:{prop:"username",label:"password"}},[t("Input",{attrs:{readonly:"",disabled:""},model:{value:e.editUserData.password,callback:function(t){e.$set(e.editUserData,"password",t)},expression:"editUserData.password"}})],1)],1),t("Col",{attrs:{span:"12"}},[t("FormItem",{attrs:{prop:"username",label:"avatar"}},[t("Input",{model:{value:e.editUserData.avatar,callback:function(t){e.$set(e.editUserData,"avatar",t)},expression:"editUserData.avatar"}})],1)],1),t("Col",{attrs:{span:"12"}},[t("FormItem",{attrs:{label:"lastSigninIP",prop:"username"}},[t("Input",{attrs:{readonly:"",disabled:""},model:{value:e.editUserData.attr.lastSigninIP,callback:function(t){e.$set(e.editUserData.attr,"lastSigninIP",t)},expression:"editUserData.attr.lastSigninIP"}})],1)],1),t("Col",{attrs:{span:"12"}},[t("FormItem",{attrs:{label:"registerIP",prop:""}},[t("Input",{attrs:{readonly:"",disabled:""},model:{value:e.editUserData.attr.registerIP,callback:function(t){e.$set(e.editUserData.attr,"registerIP",t)},expression:"editUserData.attr.registerIP"}})],1)],1),t("Col",{attrs:{span:"12"}},[t("FormItem",{attrs:{label:"createTime",prop:""}},[t("Input",{attrs:{readonly:"",disabled:""},model:{value:e.editUserData.createTime,callback:function(t){e.$set(e.editUserData,"createTime",t)},expression:"editUserData.createTime"}})],1)],1),t("Col",{attrs:{span:"12"}},[t("FormItem",{attrs:{label:"signoutTime",prop:""}},[t("Input",{attrs:{readonly:"",disabled:""},model:{value:e.editUserData.signoutTime,callback:function(t){e.$set(e.editUserData,"signoutTime",t)},expression:"editUserData.signoutTime"}})],1)],1),t("Col",{attrs:{span:"12"}},[t("FormItem",{attrs:{label:"change Name Left"}},[t("InputNumber",{attrs:{max:5,min:0},model:{value:e.editUserData.attr.changeNameLeft,callback:function(t){e.$set(e.editUserData.attr,"changeNameLeft",t)},expression:"editUserData.attr.changeNameLeft"}})],1)],1),t("Col",{attrs:{span:"12"}},[t("FormItem",{attrs:{label:e.$t("profile.account.form.language")}},[t("Select",{staticClass:"switch-language",attrs:{prefix:"md-globe",placement:"top-end"},model:{value:e.editUserData.attr.language,callback:function(t){e.$set(e.editUserData.attr,"language",t)},expression:"editUserData.attr.language"}},e._l(e.languages,(function(a){return t("Option",{key:a.name,attrs:{value:a.name}},[e._v(" "+e._s(a.label)+" ")])})),1)],1)],1),t("Col",{attrs:{span:"12"}},[t("FormItem",{attrs:{label:e.$t("profile.account.form.showOrigin")}},[t("i-switch",{model:{value:e.editUserData.attr.showOrigin,callback:function(t){e.$set(e.editUserData.attr,"showOrigin",t)},expression:"editUserData.attr.showOrigin"}})],1)],1),t("Col",{attrs:{span:"12"}},[t("FormItem",{attrs:{label:e.$t("profile.account.form.allowDM")}},[t("i-switch",{model:{value:e.editUserData.attr.allowDM,callback:function(t){e.$set(e.editUserData.attr,"allowDM",t)},expression:"editUserData.attr.allowDM"}})],1)],1)],1),t("FormItem",{attrs:{label:"privileges",prop:"privileges"}},[t("Row",{attrs:{gutter:10}},[t("Col",{attrs:{span:"24"}},[t("PrivilegesTag",{ref:"privilegesTag",attrs:{data:e.editUserData.privilege}})],1),t("Col",{attrs:{span:"24"}},[t("Row",{attrs:{gutter:10}},[t("Col",[t("Select",{staticStyle:{width:"160px"},model:{value:e.editPrivilegesForm.activeName,callback:function(t){e.$set(e.editPrivilegesForm,"activeName",t)},expression:"editPrivilegesForm.activeName"}},e._l(e.editPrivilegesForm.action,(function(a,s){return t("Option",{key:s,attrs:{value:a}},[e._v(" "+e._s(a)+" ")])})),1)],1),t("Col",{attrs:{flex:"1"}},[t("Select",{model:{value:e.editPrivilegesForm.roleName,callback:function(t){e.$set(e.editPrivilegesForm,"roleName",t)},expression:"editPrivilegesForm.roleName"}},e._l(e.editPrivilegesForm.role,(function(a,s){return t("Option",{key:s,attrs:{value:a}},[e._v(" "+e._s(e.$t("basic.privilege."+a))+" ")])})),1)],1),t("Col",[t("Button",{on:{click:e.onEditPrivileges}},[e._v(e._s(e.$t("basic.button.commit")))])],1)],1)],1)],1)],1)],1)],1)],2)},n=[],o=a("e4b4"),l=a("a7d7"),d=a("d78a"),u={data(){return{load:!1,userValue:"",userListData:[],editUserData:{attr:{language:""},temporaryPrivilege:{},privilege:[]},editPrivilegesForm:{id:"",roleName:"",role:["normal","admin","bot","super","dev","blacklisted","freezed"],activeName:"grant",action:["grant","revoke"]},userModel:!1,languages:l.child}},components:{PrivilegesTag:d["a"]},created(){this.http=o["d"].call(this)},methods:{async onSubmit(){this.load=!0,await this.setUserAttr();for(const e in this.editUserData.temporaryPrivilege)this.editUserData.id&&await this.setUser(this.editUserData.id,this.editUserData.temporaryPrivilege[e],e);await this.onSearchUser(),this.load=!1},onEditPrivileges(){if(!this.editPrivilegesForm.roleName||!this.editUserData.privilege)return;const e=this.editUserData.privilege.indexOf(this.editPrivilegesForm.roleName);switch(this.editPrivilegesForm.activeName){case"grant":e>=0?this.$Message.error("already exist"):(this.editUserData.privilege.push(this.editPrivilegesForm.roleName),this.editUserData.temporaryPrivilege[this.editPrivilegesForm.roleName]="grant");break;case"revoke":e?(this.editUserData.privilege.splice(e,1),this.editUserData.temporaryPrivilege[this.editPrivilegesForm.roleName]="revoke"):this.$Message.error("not role");break}this.$refs.privilegesTag&&this.$refs.privilegesTag.update()},async onSearchUser(){const e=this;if(this.userValue)return new Promise((t,a)=>{e.load=!0,e.http.get("admin/searchUser",{params:{name:this.userValue}}).then(t=>{const a=t.data;1!=a.success?e.$Message.error(a.code):e.userListData=a.data}).finally(()=>{e.load=!1,t()})})},onEditUser(e){this.userModel=!0,this.editUserData=Object.assign(this.editUserData,this.userListData[e]),this.$refs.privilegesTag&&this.$refs.privilegesTag.update(this.editUserData.privilege)},async setUser(e,t,a){await this.http.post("admin/setUser",{data:{data:{id:e,action:t,role:a}}}).then(e=>{const t=e.data;1!=t.success&&this.$Message.error(t.code)})},async setUserAttr(){await this.http.post("admin/setUserAttr",{data:{data:{id:this.editPrivilegesForm.id,attr:this.editUserData.attr,username:this.editUserData.username}}}).then(e=>{const t=e.data;1!=t.success&&this.$Message.error(t.code)})}},computed:{}},c=u,m=(a("0b2c"),a("2877")),p=Object(m["a"])(c,r,n,!1,null,"ec5522ec",null),g=p.exports,h=function(){var e=this,t=e._self._c;return t("div",[e._v(" under construction ")])},v=[],f={data(){return{}},created(){this.http=o["d"].call(this)},methods:{setComment(){this.http.post("admin/setComment",{data:{data:{id:"",content:"content",videoLink:""}}}).then(e=>{const t=e.data;t.success})}}},b=f,_=Object(m["a"])(b,h,v,!1,null,null,null),U=_.exports,D=function(){var e=this,t=e._self._c;return t("div")},w=[],C={data(){return{}},created(){this.http=o["d"].call(this)},methods:{}},I=C,P=Object(m["a"])(I,D,w,!1,null,null,null),k=P.exports,y=function(){var e=this,t=e._self._c;return t("div",[t("Row",[t("Col",{attrs:{flex:"1"}},[t("Page",{staticClass:"page",attrs:{size:"small","show-sizer":"","show-total":"","show-elevator":"","page-size":e.limit,current:e.skip,total:e.total},on:{"on-change":e.handlePageChange,"on-page-size-change":e.handlePageSizeChange}})],1),t("Col",[t("Button",{attrs:{size:"small",loading:e.load},on:{click:e.getAdminjudgementLog}},[e._v(e._s(e.$t("basic.button.submit")))])],1)],1),t("br"),t("Card",{attrs:{"dis-hover":"",padding:5}},[e.judgementLog.length>0?e._l(e.judgementLog,(function(a,s){return t("div",{key:s},[t("Row",{attrs:{type:"flex",align:"middle"}},[t("Col",[t("Tag",[e._v("Log")])],1),t("Col",{attrs:{flex:"1"}},[t("div",[t("Time",{attrs:{time:a.createTime}}),e._v(": "),t("BusinessCard",{attrs:{id:a.byUserId}},[t("b",[e._v(e._s(a.username))])]),e._v(" -> "),t("span",[e._v(e._s(e.$t(`basic.action.${a.judgeAction}.text`)))]),e._v("-> "),t("span",[e._v(e._s(a.toOriginPersonaId))])],1)]),t("Col",[t("router-link",{attrs:{to:{name:"player",params:{ouid:a.toOriginPersonaId}}}},[t("Icon",{attrs:{type:"ios-eye",size:"30"}})],1)],1)],1)],1)})):[e._v(" "+e._s(e.$t("basic.tip.notcontent"))+" ")]],2),t("br"),t("Page",{staticClass:"page",attrs:{size:"small","show-sizer":"","show-total":"","show-elevator":"","page-size":e.limit,current:e.skip,total:e.total},on:{"on-change":e.handlePageChange,"on-page-size-change":e.handlePageSizeChange}})],1)},x=[],$=a("6ea1"),M={data(){return{load:!1,judgementLog:[],limit:100,skip:1,total:0}},components:{BusinessCard:$["a"]},created(){this.http=o["d"].call(this),this.getAdminjudgementLog()},methods:{getAdminjudgementLog(){this.load||(this.load=!0,this.http.get(o["b"]["admin_judgementLog"],{params:{limit:this.limit,skip:this.skip,total:this.total}}).then(e=>{const t=e.data;1==t.success&&(this.judgementLog=t.data,this.total=t.total)}).finally(()=>{this.load=!1}))},handlePageSizeChange(e){this.limit=e,this.getAdminjudgementLog()},handlePageChange(e){this.skip=e,this.getAdminjudgementLog()}}},F=M,L=Object(m["a"])(F,y,x,!1,null,null,null),j=L.exports,S={name:"profile",data(){return{privileges:[],openMuen:["comment","comm","log"],adminMenuValue:"user",adminMuen:[{title:"management",child:[{title:"user",value:"user"},{title:"comment",value:"comment"}]},{title:"log",icon:"ios-paper",child:[{title:"adminLog",value:"admin_log"},{title:"judgementLog",value:"judgement_log"}]}]}},components:{user:g,comment:U,log:k,judgementLog:j},methods:{onMenuActive(e){this.adminMenuValue=e,this.$router.push({name:"admin",params:{pagename:e}})}},computed:{isLogin(){return Boolean(this.$store.state.user)},isAdmin(){const e=this.$store.state.user,t=!!e&&e.userinfo.privilege.concat("").includes("admin");return Boolean(t)},currentUser(){return this.$store.state.user}}},N=S,T=(a("ba7d"),Object(m["a"])(N,s,i,!1,null,"4f79d6f4",null));t["default"]=T.exports},"479e":function(e,t,a){},5011:function(e,t,a){},"525c":function(e,t,a){},"6ea1":function(e,t,a){"use strict";var s=function(){var e=this,t=e._self._c;return t("Poptip",{attrs:{padding:e.padding,width:e.width,trigger:"hover",placement:"bottom",transfer:!0},on:{"on-popper-show":e.getUserInfo}},[e._t("default"),t("div",{staticClass:"business",attrs:{slot:"content"},slot:"content"},[e.loadErr?[t("Row",[t("Col",{attrs:{align:"center"}},[t("Icon",{attrs:{type:"md-alert",size:"40",color:"red"}})],1)],1)]:[t("div",{staticClass:"business-img"},[t("img",{attrs:{src:a("e124")}})]),t("Row",[t("Col",{attrs:{flex:"1"}},[t("h2",[e._v(" "+e._s(e.userInfo.username)+" ")]),e.userInfo.privilege?t("PrivilegesTag",{attrs:{data:e.userInfo.privilege}}):e._e()],1),t("Col",[e._v(" # "+e._s(e.userInfo.id)+" ")])],1),t("br"),t("Card",{attrs:{"dis-hover":""}},[t("p",{domProps:{innerHTML:e._s(e.userInfo.introduction||"(✿◡‿◡)")}})]),t("br"),t("Row",[t("Col",{attrs:{flex:"auto"}}),t("Col",[t("router-link",{attrs:{to:{path:"/account/"+e.userInfo.id,query:{repeat:!0}}}},[t("Button",[t("Icon",{attrs:{type:"ios-send",size:"20"}})],1)],1)],1)],1)],t("Spin",{directives:[{name:"show",rawName:"v-show",value:e.spinShow,expression:"spinShow"}],attrs:{size:"large",fix:""}},[t("Icon",{staticClass:"spin-icon-load",attrs:{type:"ios-loading",size:"50"}}),t("p",[e._v("ヾ(◍°∇°◍)ﾉﾞ load...")])],1)],2)],2)},i=[],r=a("e4b4"),n=a("d78a"),o={props:{width:{type:Number,default:400},id:Number,padding:{type:String,default:"0"}},data(){return{localBusinessMap:{},userInfo:{},spinShow:!1,loadErr:!1,type:"user"}},components:{PrivilegesTag:n["a"]},methods:{getUserInfo(){const e="business";let t=r["g"].session().get(e);if(0==t.code&&(this.localBusinessMap=t.data.value,this.localBusinessMap[this.id]&&(this.userInfo=this.localBusinessMap[this.id])),!(Object.keys(this.userInfo).length>0))switch(this.spinShow=!0,this.type){case"user":r["c"].get(r["b"]["user_info"],{params:{id:this.id}}).then(t=>{const a=t.data;1==a.success?(this.userInfo=a.data,this.localBusinessMap[this.userInfo.id]=this.userInfo,r["g"].session().set(e,this.localBusinessMap)):this.catch()}).catch(()=>{this.loadErr=!0}).finally(()=>{this.spinShow=!1});break}}}},l=o,d=(a("20aa"),a("2877")),u=Object(d["a"])(l,s,i,!1,null,null,null);t["a"]=u.exports},ba7d:function(e,t,a){"use strict";a("479e")},e124:function(e,t,a){e.exports=a.p+"assets/img/bf.b384c970.jpg"}}]);
//# sourceMappingURL=chunk-f1c45516.2.6.0.js.map